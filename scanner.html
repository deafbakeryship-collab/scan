<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸª é¤…ä¹¾åº«å­˜æƒæç³»çµ±</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
        body { font-family: sans-serif; text-align: center; background-color: #f4f4f4; margin: 0; padding: 20px; }
        #reader { width: 100%; max-width: 500px; margin: auto; background: white; padding: 10px; border-radius: 8px; }
        .result-card { background: white; margin-top: 20px; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .status-msg { color: #2ecc71; font-weight: bold; font-size: 1.2em; }
        button { padding: 10px 20px; margin: 10px; font-size: 16px; cursor: pointer; border-radius: 5px; border: none; background: #3498db; color: white; }
    </style>
</head>
<body>

    <h1>ğŸª é¤…ä¹¾åº«å­˜æƒæ</h1>
    
    <div id="reader"></div>

    <div class="result-card">
        <h3>æƒæçµæœï¼š<span id="scan-result" style="color:red;">ç­‰å¾…æƒæ...</span></h3>
        <p id="action-msg">åµæ¸¬åˆ°æ¢ç¢¼å¾Œï¼Œè«‹é¸æ“‡æ“ä½œï¼š</p>
        <button onclick="updateStock(1)">â• å…¥åº« (+1)</button>
        <button onclick="updateStock(-1)" style="background:#e74c3c;">â– å‡ºåº« (-1)</button>
    </div>

    <script>
        let lastResult = "";

        function onScanSuccess(decodedText, decodedResult) {
            // é¿å…é‡è¤‡æƒæåŒä¸€å€‹æ¢ç¢¼
            if (decodedText !== lastResult) {
                lastResult = decodedText;
                document.getElementById('scan-result').innerText = decodedText;
                // æ‰‹æ©Ÿéœ‡å‹•æç¤º (éƒ¨åˆ†æ‰‹æ©Ÿæ”¯æ´)
                if (navigator.vibrate) navigator.vibrate(100);
            }
        }

        function updateStock(change) {
            if (!lastResult) {
                alert("è«‹å…ˆæƒææ¢ç¢¼ï¼");
                return;
            }
            // é€™è£¡ç›®å‰å…ˆç”¨å½ˆçª—æ¨¡æ“¬ï¼Œä¹‹å¾Œå¯ä¸²æ¥è³‡æ–™åº«
            alert(`ç”¢å“ ${lastResult} å·²æˆåŠŸèª¿æ•´åº«å­˜: ${change > 0 ? '+1' : '-1'}`);
        }

        // åˆå§‹åŒ–æƒæå™¨
        const html5QrcodeScanner = new Html5QrcodeScanner(
            "reader", { fps: 10, qrbox: {width: 250, height: 150} }
        );
        html5QrcodeScanner.render(onScanSuccess);
    </script>
</body>
</html>